<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bunamaw - My Account</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&family=Noto+Sans+Ethiopic:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        html, body { 
            height: 100%; 
            margin: 0; 
            padding: 0; 
            overflow: hidden; 
            background: #eef2f7; 
            font-family: 'Noto Sans Ethiopic', sans-serif; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
        }
        
        .en-mode { font-family: 'Poppins', sans-serif !important; }

        .card { 
            width: 92%; 
            max-width: 360px; 
            background: white; 
            border-radius: 20px; 
            box-shadow: 0 15px 35px rgba(0,45,75,0.25); 
            overflow: hidden; 
            border: 4px solid #002d4b; 
            display: flex; 
            flex-direction: column;
        }
        
        .yellow-bar { background: #002d4b; padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; font-weight: 1000; font-size: 18px; color: #fff; }
        .header-line { height: 4px; background: #ff8c00; width: 100%; }
        
        .content { padding: 15px 20px; }
        
        .dt-section { border-bottom: 3px solid #002d4b; padding-bottom: 8px; margin-bottom: 12px; }
        .dt-row { font-weight: 1000; font-size: 16px; color: #002d4b; text-transform: uppercase; }

        .branding { display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 10px; }
        .branding i { color: #8B4513; font-size: 26px; }
        .branding h1 { color: #8B4513; margin: 0; font-size: 28px; font-weight: 1000; letter-spacing: -1px; }

        .label-text { color: #002d4b; font-weight: 1000; font-size: 13px; margin-bottom: 4px; display: block; text-transform: uppercase; }
        
        .input-box { border: 3px solid #002d4b; border-radius: 10px; padding: 0 12px; display: flex; align-items: center; background: #fff; height: 38px; margin-bottom: 10px; }
        .input-box i { color: #002d4b; margin-right: 10px; font-size: 16px; width: 18px; text-align: center; }
        input { border: none; outline: none; width: 100%; font-size: 17px; font-weight: 1000; color: #002d4b; font-family: inherit; background: transparent; }

        .flex-row { display: flex; gap: 8px; margin-bottom: 10px; }
        .sms-btn { background: #002d4b; color: white; border: none; border-radius: 10px; font-weight: 1000; font-size: 12px; cursor: pointer; height: 38px; width: 85px; text-transform: uppercase; }

        .grid-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }

        /* በተኖች - Underline ተወግዷል */
        .btn { 
            width: 100%; 
            height: 42px; 
            border-radius: 10px; 
            border: none; 
            font-weight: 1000; 
            cursor: pointer; 
            font-size: 14px; 
            text-transform: uppercase; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            text-decoration: none !important; /* መስመሩን የሚያጠፋው ይሄ ነው */
        }
        
        .save-btn { background: #ff8c00; color: white; }
        .info-btn { background: #00b050; color: white; }
        .del-btn { background: #d00000; color: white; margin-bottom: 8px; height: 40px; border: 3px solid #a00000; }
        .back-btn { background: #002d4b; color: white; height: 40px; }

        #msg-display { font-weight: 1000; font-size: 12px; text-align: center; height: 16px; margin-bottom: 4px; }
        
        .footer { border-top: 3px solid #002d4b; padding: 12px 15px; display: flex; justify-content: space-between; font-size: 14px; font-weight: 1000; background: #fff; }
        .lang-btn { cursor: pointer; color: #002d4b; }
        .lang-btn.active { color: #ff8c00; }
    </style>
</head>
<body>

<div class="card">
    <div class="yellow-bar">
        <span id="top-title">መለያዬ</span>
        <span style="color:#ff8c00; font-size:24px; font-weight: 1000;">18+</span>
    </div>
    <div class="header-line"></div>

    <div class="content">
        <div class="dt-section">
            <div class="dt-row" id="date-label">DATE: LOADING...</div>
            <div class="dt-row" id="time-label">TIME: 00:00:00</div>
        </div>

        <div class="branding">
            <i class="fas fa-coffee"></i>
            <h1 id="brand-name">ቡናማዉ ፈጣን</h1>
        </div>
        
        <div id="msg-display"></div>
        
        <label class="label-text" id="ph-label">ስልክ ቁጥር</label>
        <div class="input-box">
            <i class="fas fa-phone"></i>
            <input type="tel" id="p-input" placeholder="09..." oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 10);">
        </div>

        <label class="label-text" id="pw-label">የድሮ ፒን</label>
        <div class="flex-row">
            <div class="input-box" style="flex:1; margin-bottom:0;">
                <i class="fas fa-lock"></i>
                <input type="password" id="old-pass" placeholder="****" maxlength="5">
            </div>
            <button class="sms-btn" id="sms-btn" onclick="handleSMS()">SMS</button>
        </div>

        <label class="label-text" id="new-pw-label">አዲስ ፒን</label>
        <div class="input-box">
            <i class="fas fa-key"></i>
            <input type="password" id="new-pass" placeholder="****" maxlength="5">
        </div>

        <div class="grid-buttons">
            <button class="btn save-btn" id="save-btn" onclick="handleSave()">ቀይር</button>
            <a href="info.html" class="btn info-btn" id="info-btn">መመሪያ</a>
        </div>

        <button class="btn del-btn" id="del-btn" onclick="handleDelete()">አካውንት ሰርዝ</button>
        <button class="btn back-btn" id="back-txt" onclick="window.location.href='index.html'">ተመለስ</button>
    </div>

    <div class="footer">
        <div id="l-text">ቋንቋ</div>
        <div class="lang-options">
            <span id="lang-am" class="lang-btn active" onclick="setLang('am')">አማርኛ</span> | 
            <span id="lang-en" class="lang-btn" onclick="setLang('en')">ENGLISH</span>
        </div>
    </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyAApcQQ3XySdQ6YG4wnrTUPnm0wZB078QQ",
        authDomain: "bekas-fast-d2a3b.firebaseapp.com",
        databaseURL: "https://bekas-fast-d2a-default-rtdb.firebaseio.com",
        projectId: "bekas-fast-d2a3b",
        storageBucket: "bekas-fast-d2a3b.firebasestorage.app",
        messagingSenderId: "130702344830",
        appId: "1:130702344830:web:58577289ec2f3208a64e2f"
    };

    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    let currentLang = 'am';

    function updateClock() {
        const n = new Date();
        const mEN = ["JANUARY", "FEBRUARY", "MARCH", "APRIL", "MAY", "JUNE", "JULY", "AUGUST", "SEPTEMBER", "OCTOBER", "NOVEMBER", "DECEMBER"];
        const mAM = ["ጥር", "የካቲት", "መጋቢት", "ሚያዝያ", "ግንቦት", "ሰኔ", "ሐምሌ", "ነሐሴ", "መስከረም", "ጥቅምት", "ህዳር", "ታህሳስ"];
        let hours = n.getHours(); 
        const ampmAM = hours >= 12 ? ' ከሰዓት' : ' ጠዋት';
        const ampmEN = hours >= 12 ? ' PM' : ' AM';
        hours = hours % 12 || 12;
        
        if(currentLang === 'am') {
            document.getElementById('date-label').innerText = "ቀን: " + mAM[n.getMonth()] + " " + n.getDate() + ", " + n.getFullYear();
            document.getElementById('time-label').innerText = "ሰዓት: " + hours + ":" + n.getMinutes().toString().padStart(2, '0') + ":" + n.getSeconds().toString().padStart(2, '0') + ampmAM;
        } else {
            document.getElementById('date-label').innerText = "DATE: " + mEN[n.getMonth()] + " " + n.getDate() + ", " + n.getFullYear();
            document.getElementById('time-label').innerText = "TIME: " + hours + ":" + n.getMinutes().toString().padStart(2, '0') + ":" + n.getSeconds().toString().padStart(2, '0') + ampmEN;
        }
    }
    setInterval(updateClock, 1000);

    function setLang(l) {
        currentLang = l;
        document.body.classList.toggle('en-mode', l === 'en');
        const s = l === 'am' ? 
            { t:'መለያዬ', ph:'ስልክ ቁጥር', op:'የድሮ ፒን', sms:'SMS', np:'አዲስ ፒን', sv:'ቀይር', if:'መመሪያ', dl:'አካውንት ሰርዝ', bn:'ቡናማዉ ፈጣን', lt:'ቋንቋ', bk:'ተመለስ' } :
            { t:'MY ACCOUNT', ph:'PHONE', op:'OLD PIN', sms:'SMS', np:'NEW PIN', sv:'SAVE', if:'INFO', dl:'DELETE', bn:'BUNAMAW', lt:'LANGUAGE', bk:'BACK' };
        
        document.getElementById('top-title').innerText = s.t;
        document.getElementById('ph-label').innerText = s.ph;
        document.getElementById('pw-label').innerText = s.op;
        document.getElementById('sms-btn').innerText = s.sms;
        document.getElementById('new-pw-label').innerText = s.np;
        document.getElementById('save-btn').innerText = s.sv;
        document.getElementById('info-btn').innerText = s.if;
        document.getElementById('del-btn').innerText = s.dl;
        document.getElementById('brand-name').innerText = s.bn;
        document.getElementById('l-text').innerText = s.lt;
        document.getElementById('back-txt').innerText = s.bk;
        
        document.getElementById('lang-am').className = l === 'am' ? 'lang-btn active' : 'lang-btn';
        document.getElementById('lang-en').className = l === 'en' ? 'lang-btn active' : 'lang-btn';
        updateClock();
    }

    window.onload = function() { updateClock(); };

    function showMsg(txt, color) {
        const d = document.getElementById('msg-display');
        d.innerText = txt; d.style.color = color;
        setTimeout(() => d.innerText = "", 3000);
    }

    function handleSMS() {
        const ph = document.getElementById('p-input').value.trim();
        if(ph.length < 10) { showMsg(currentLang==='am'?"ስልክ ያስገቡ":"ENTER PHONE", "red"); return; }
        database.ref('password_requests').push({ phone: ph, time: new Date().toLocaleString() });
        showMsg("SENT!", "green");
    }

    function handleSave() {
        const ph = document.getElementById('p-input').value.trim();
        const oldP = document.getElementById('old-pass').value.trim();
        const newP = document.getElementById('new-pass').value.trim();
        if(!ph || !oldP || !newP) { showMsg("FILL INFO", "red"); return; }
        database.ref('users/'+ph).once('value').then(snap => {
            if(snap.exists() && snap.val().password === oldP) {
                database.ref('users/'+ph).update({password: newP}).then(() => {
                    showMsg("SUCCESS!", "green");
                    setTimeout(() => window.location.href="index.html", 1500);
                });
            } else { showMsg("ERROR", "red"); }
        });
    }

    function handleDelete() {
        const ph = document.getElementById('p-input').value.trim();
        if(!ph) return;
        if(confirm(currentLang==='am'?"አካውንቱን ማጥፋት ይፈልጋሉ?":"DELETE?")) {
            database.ref('users/'+ph).remove().then(() => window.location.href="index.html");
        }
    }
</script>
</body>
</html>
